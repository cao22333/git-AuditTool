# 审计工具箱 (AuditTool)

## 简介
审计工具箱是一个旨在提高财务审计效率的桌面应用程序，目前正在开发。它集成了多个实用工具，帮助审计师处理超大CSV文件、管理文件夹状态以及进行科目勾稽等任务。本工具的UI界面采用Python的Tkinter库开发，界面简洁直观，易于操作。

## 功能特性
本工具箱包含以下主要功能：

1.  **超大 CSV 文件处理**
    *   **多文件合并**: 将多个CSV文件合并为一个，支持自动检测编码和分隔符，并可选择分块处理以应对大文件。
    *   **数据汇总**: 根据指定列对数据进行分组求和，支持数值列的自动转换和结果排序。可处理大文件。
    *   **数据筛选**: 根据Excel文件中提供的条件对CSV数据进行筛选，支持分块处理。

2.  **文件夹状态管理**
    *   **智能分析**: 自动检测指定目录下父文件夹及其子文件夹的状态（空、非空、部分空）。
    *   **后缀更新**: 根据文件夹内容状态，自动添加、移除或更正文件夹名称的后缀（如"-空", "-缺", "-全空"）。
    *   **操作预览**: 提供详细的重命名操作预览，确保用户在执行前了解所有更改。
    *   **备份与撤销**: 支持在执行操作前创建备份，并提供撤销最近操作的功能。

3.  **科目勾稽**
    *   **薪酬勾稽**: 根据账套文件和映射表，自动核对薪酬相关科目的贷方发生额。
    *   **资产折旧摊销勾稽**: 根据原始报表文件和折旧分配表模板，自动填写资产折旧摊销数据。
    *   **Excel自动化**: 利用`xlwings`库实现与Excel的深度交互，高效完成数据填写和报告生成。

## 安装与运行

本项目采用了uv管理工具，不适用pip等管理工具，不需要提前创建虚拟环境，但需要提前安装uv：

如果您系统环境已经安装了pip，可以直接在cmd中使用命令：`pip install uv`安装uv；
或者使用 irm 下载脚本并通过 iex 执行：
`powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"`

## 使用说明

### 启动应用
在确保系统环境中存在uv后，运行 `uv run main.py` 后，将打开审计工具箱的主界面。界面左侧为功能导航菜单，右侧为内容显示区域。

### 1. CSV 文件处理
*   点击左侧菜单的“CSV 文件处理”按钮。
*   在打开的标签页中，您可以选择“多文件合并”、“数据汇总”或“数据筛选”功能。
*   **多文件合并**:
    *   选择要合并的CSV文件（可多选）。
    *   选择输出的CSV文件路径。
    *   可配置编码、分隔符和是否启用大文件分块处理。
    *   点击“开始合并”执行。
*   **数据汇总**:
    *   选择CSV数据文件。
    *   点击“下一步”加载列信息。
    *   选择分组列和要进行求和的列（可多选），可选择降序排列。
    *   点击“开始汇总”执行，结果将保存为Excel文件。
*   **数据筛选**:
    *   选择CSV数据文件和包含筛选条件的Excel文件（Excel第一列为筛选值）。
    *   点击“下一步”加载列信息。
    *   选择要筛选的列。
    *   点击“开始筛选”执行，结果将保存为Excel文件。

### 2. 文件夹状态管理
*   点击左侧菜单的“文件夹状态管理”按钮。
*   **选择目录**: 点击“选择目录”按钮选择要分析的根文件夹，或将文件夹拖放到指定区域。
*   **后缀配置**: 配置用于标记空子文件夹、部分空父文件夹和全部空父文件夹的后缀。
*   **处理选项**:
    *   `自动分析选定目录`: 切换目录后是否自动进行分析。
    *   `移除正确状态的后缀`: 非空文件夹如果带有空后缀，是否自动移除。
    *   `执行前创建备份`: 在执行重命名操作前，是否创建当前目录的备份。
*   **分析**: 点击“分析”按钮，工具将分析文件夹结构并在“统计”标签页显示报告。
*   **生成预览**: 点击“生成预览”按钮，在“预览”标签页显示所有建议的重命名操作。
*   **执行处理**: 确认预览无误后，点击“执行处理”按钮，工具将根据预览执行重命名操作。
*   **撤销操作**: 如果执行了重命名，可以点击“撤销操作”按钮撤销最近一次的重命名批次。
*   **导出报告**: 将统计分析报告导出为文本文件。

### 3. 科目勾稽
*   点击左侧菜单的“科目勾稽”按钮。
*   在打开的标签页中，您可以选择“薪酬勾稽”或“资产折旧摊销勾稽”功能。
*   **薪酬勾稽**:
    *   选择账套文件所在的目录。
    *   选择包含勾稽映射关系的Excel文件。
    *   选择输出底稿文件存放的目录。
    *   点击“开始薪酬勾稽”执行。
*   **资产折旧摊销勾稽**:
    *   选择原始报表文件所在的目录。
    *   选择折旧分配表模板文件。
    *   选择输出底稿文件存放的目录。
    *   点击“开始资产折旧摊销勾稽”执行。

## 注意事项
*   请确保所有输入文件路径正确，并且具有读写权限。
*   `xlwings` 功能的正常使用依赖于本地安装的 Microsoft Excel 应用程序。
*   对于大文件处理，请耐心等待，进度条会显示当前进度。
*   建议在处理重要数据前，务必备份您的文件。
